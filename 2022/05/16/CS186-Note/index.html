<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222" media="(prefers-color-scheme: light)">
<meta name="theme-color" content="#222" media="(prefers-color-scheme: dark)"><meta name="generator" content="Hexo 5.4.2">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css" integrity="sha256-DfWjNxDkM94fVBWx1H5BMMp0Zq7luBlV8QRcSES7s+0=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"mitmoksha.github.io","root":"/","images":"/images","scheme":"Muse","darkmode":true,"version":"8.11.1","exturl":false,"sidebar":{"position":"left","display":"hide","padding":18,"offset":12},"copycode":false,"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":false,"async":false,"transition":{"post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"Searching...","empty":"We didn't find any results for the search: ${query}","hits_time":"${hits} results found in ${time} ms","hits":"${hits} results found"},"path":"/search.xml","localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false}}</script><script src="/js/config.js"></script>

    <meta name="description" content="CS186 Note SQL  SELECT后加DISTINCT可以将重复的tuple去掉。 12SELECT DISTINCT &lt;columns&gt;FROM &lt;tbl&gt;;  NULL value  任何以NULL值作为操作数的算数运算操作结果都为NULL，所以通常需要IS NULL或IS NOT NULL来提前判断。 NULL is falsey.  A">
<meta property="og:type" content="article">
<meta property="og:title" content="CS186 Note">
<meta property="og:url" content="https://mitmoksha.github.io/2022/05/16/CS186-Note/index.html">
<meta property="og:site_name" content="Moksha&#39;s Blog">
<meta property="og:description" content="CS186 Note SQL  SELECT后加DISTINCT可以将重复的tuple去掉。 12SELECT DISTINCT &lt;columns&gt;FROM &lt;tbl&gt;;  NULL value  任何以NULL值作为操作数的算数运算操作结果都为NULL，所以通常需要IS NULL或IS NOT NULL来提前判断。 NULL is falsey.  A">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://pic4.zhimg.com/80/v2-e51e235585811be04b61e04c12a2d1e0.png">
<meta property="article:published_time" content="2022-05-16T10:07:44.000Z">
<meta property="article:modified_time" content="2022-05-16T10:12:44.740Z">
<meta property="article:author" content="Pishun Huang">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://pic4.zhimg.com/80/v2-e51e235585811be04b61e04c12a2d1e0.png">


<link rel="canonical" href="https://mitmoksha.github.io/2022/05/16/CS186-Note/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"en","comments":true,"permalink":"https://mitmoksha.github.io/2022/05/16/CS186-Note/","path":"2022/05/16/CS186-Note/","title":"CS186 Note"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>CS186 Note | Moksha's Blog</title>
  





  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
<link rel="alternate" href="/atom.xml" title="Moksha's Blog" type="application/atom+xml">
</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="headband"></div>

  <main class="main">
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">Moksha's Blog</p>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>About</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>Categories</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>Search
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup"><div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off" maxlength="80"
           placeholder="Searching..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close" role="button">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div class="search-result-container no-result">
  <div class="search-result-icon">
    <i class="fa fa-spinner fa-pulse fa-5x"></i>
  </div>
</div>

    </div>
  </div>

</div>
        
  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>

  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#cs186-note"><span class="nav-number">1.</span> <span class="nav-text">CS186 Note</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#sql"><span class="nav-number">1.1.</span> <span class="nav-text">SQL</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#null-value"><span class="nav-number">1.1.1.</span> <span class="nav-text">NULL value</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#aggregate-funtion"><span class="nav-number">1.1.2.</span> <span class="nav-text">Aggregate funtion</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#groups-of-data"><span class="nav-number">1.1.3.</span> <span class="nav-text">Groups of Data</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%9C%89%E9%97%AE%E9%A2%98%E7%9A%84%E6%9F%A5%E8%AF%A2%E8%AF%AD%E5%8F%A5"><span class="nav-number">1.1.4.</span> <span class="nav-text">有问题的查询语句</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#order-by"><span class="nav-number">1.1.5.</span> <span class="nav-text">Order By</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#limit"><span class="nav-number">1.1.6.</span> <span class="nav-text">LIMIT</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%AF%AD%E5%8F%A5%E7%BC%96%E5%86%99%E9%A1%BA%E5%BA%8F"><span class="nav-number">1.1.7.</span> <span class="nav-text">语句编写顺序</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#join"><span class="nav-number">1.1.8.</span> <span class="nav-text">Join</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#name-conflict"><span class="nav-number">1.1.9.</span> <span class="nav-text">Name conflict</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#correlated-subqueries"><span class="nav-number">1.1.10.</span> <span class="nav-text">Correlated Subqueries</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#pattern-matching"><span class="nav-number">1.1.11.</span> <span class="nav-text">Pattern matching</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#regular-expression"><span class="nav-number">1.1.12.</span> <span class="nav-text">Regular expression</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#relation-algerbra"><span class="nav-number">1.2.</span> <span class="nav-text">Relation Algerbra</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#projectionpi"><span class="nav-number">1.2.1.</span> <span class="nav-text">Projection(\(\pi\))</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#selectionsigma"><span class="nav-number">1.2.2.</span> <span class="nav-text">Selection(\(\sigma\))</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#unioncup"><span class="nav-number">1.2.3.</span> <span class="nav-text">Union(\(\cup\))</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#set-difference-"><span class="nav-number">1.2.4.</span> <span class="nav-text">Set Difference(\(-\))</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#intersectioncap"><span class="nav-number">1.2.5.</span> <span class="nav-text">Intersection(\(\cap\))</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#crossproducttimes"><span class="nav-number">1.2.6.</span> <span class="nav-text">CrossProduct(\(\times\))</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#joinjoin"><span class="nav-number">1.2.7.</span> <span class="nav-text">Join(\(\Join\))</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#renamerho"><span class="nav-number">1.2.8.</span> <span class="nav-text">Rename(\(\rho\))</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#group-by-aggregationgamma"><span class="nav-number">1.2.9.</span> <span class="nav-text">Group By&#x2F; Aggregation(\(\gamma\))</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#sql---relation-algebra"><span class="nav-number">1.2.10.</span> <span class="nav-text">SQL -&gt; Relation Algebra</span></a></li></ol></li></ol></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author site-overview-item animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">Pishun Huang</p>
  <div class="site-description" itemprop="description">Opportunities are ready for it, the more to beat action.</div>
</div>
<div class="site-state-wrap site-overview-item animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">27</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">11</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
  </nav>
</div>



        </div>
      </div>
    </div>
  </aside>
  <div class="sidebar-dimmer"></div>


    </header>

    
  <div class="back-to-top" role="button" aria-label="Back to top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>
  <div class="reading-progress-bar"></div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="en">
    <link itemprop="mainEntityOfPage" href="https://mitmoksha.github.io/2022/05/16/CS186-Note/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Pishun Huang">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Moksha's Blog">
      <meta itemprop="description" content="Opportunities are ready for it, the more to beat action.">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="CS186 Note | Moksha's Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          CS186 Note
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>
      

      <time title="Created: 2022-05-16 18:07:44 / Modified: 18:12:44" itemprop="dateCreated datePublished" datetime="2022-05-16T18:07:44+08:00">2022-05-16</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Computer-Science-Notes/" itemprop="url" rel="index"><span itemprop="name">Computer Science Notes</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
        <h1 id="cs186-note"><strong>CS186 Note</strong></h1>
<h2 id="sql"><strong>SQL</strong></h2>
<ul>
<li><code>SELECT</code>后加<code>DISTINCT</code>可以将重复的tuple去掉。 <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">DISTINCT</span> <span class="operator">&lt;</span>columns<span class="operator">&gt;</span></span><br><span class="line"><span class="keyword">FROM</span> <span class="operator">&lt;</span>tbl<span class="operator">&gt;</span>;</span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="null-value">NULL value</h3>
<ul>
<li>任何以<code>NULL</code>值作为操作数的算数运算操作结果都为<code>NULL</code>，所以通常需要<code>IS NULL</code>或<code>IS NOT NULL</code>来提前判断。</li>
<li><code>NULL</code> is <strong>falsey</strong>.</li>
</ul>
<h3 id="aggregate-funtion">Aggregate funtion</h3>
<ul>
<li>SUM, AVG, MAX, MIN, COUNT。</li>
<li>输入是一个列，输出是一个值。</li>
<li>每个aggregate都忽略掉<code>NULL</code>, 除了<code>COUNT(*)</code>之外。注意<code>COUNT&lt;column&gt;</code>返回具体列非空值的数量。</li>
<li>注意分组后COUNT(*)计算的是当前组的行数。 <img src="https://pic4.zhimg.com/80/v2-e51e235585811be04b61e04c12a2d1e0.png" alt="Image" /></li>
</ul>
<h3 id="groups-of-data">Groups of Data</h3>
<ul>
<li>GROUP BY</li>
<li>将当前列中属性值相同的行放入一个组中, 该组中的所有行要合并为一行。 <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">&lt;</span>columns<span class="operator">&gt;</span></span><br><span class="line"><span class="keyword">FROM</span> <span class="operator">&lt;</span>tbl<span class="operator">&gt;</span></span><br><span class="line"><span class="keyword">WHERE</span> <span class="operator">&lt;</span>predicate<span class="operator">&gt;</span> −− <span class="keyword">Filter</span> <span class="keyword">out</span> <span class="keyword">rows</span> (before <span class="keyword">grouping</span>) .</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> <span class="operator">&lt;</span>columns<span class="operator">&gt;</span></span><br><span class="line"><span class="keyword">HAVING</span> <span class="operator">&lt;</span>predicate<span class="operator">&gt;</span>; −− <span class="keyword">Filter</span> <span class="keyword">out</span> <span class="keyword">groups</span> (after <span class="keyword">grouping</span>) .</span><br></pre></td></tr></table></figure></li>
<li>WHERE用于过滤行，而HAVING用来过滤组。</li>
</ul>
<h3 id="有问题的查询语句">有问题的查询语句</h3>
<ul>
<li>投影的属性<code>AVG(num dogs)</code>是只有一个值，但是<code>age</code>属性中有很多值。因此形成的表中必须有同样数量的行，error。 <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> age, <span class="built_in">AVG</span>(num_dogs)</span><br><span class="line"><span class="keyword">FROM</span> Person;</span><br></pre></td></tr></table></figure></li>
<li>将age分为一个组之后，无法合并为一行(因为age在当前组中含单个数字，但num_dogs含多个数字)，error。 <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> age, num_dogs</span><br><span class="line"><span class="keyword">FROM</span> Person</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> age;</span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="order-by">Order By</h3>
<ul>
<li>默认是升序排列的，要想降序排列需要具体列名(属性名)后加关键字DESC。下面语句列num_dogs按升序排列，但name按降序排列。我们先对num_dogs排序再对num_dogs中相同的行进行name降序排序。 <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> name, num_dogs</span><br><span class="line"><span class="keyword">FROM</span> Person</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> num_dogs ,name <span class="keyword">DESC</span>;</span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="limit">LIMIT</h3>
<ul>
<li>限定返回的行数</li>
</ul>
<h3 id="语句编写顺序">语句编写顺序</h3>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">&lt;</span>columns<span class="operator">&gt;</span></span><br><span class="line"><span class="keyword">FROM</span> <span class="operator">&lt;</span>tbl<span class="operator">&gt;</span></span><br><span class="line"><span class="keyword">WHERE</span> <span class="operator">&lt;</span>predicate<span class="operator">&gt;</span></span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> <span class="operator">&lt;</span>columns<span class="operator">&gt;</span></span><br><span class="line"><span class="keyword">HAVING</span> <span class="operator">&lt;</span>predicate<span class="operator">&gt;</span></span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> <span class="operator">&lt;</span>columns<span class="operator">&gt;</span></span><br><span class="line">LIMIT <span class="operator">&lt;</span>num<span class="operator">&gt;</span>;</span><br></pre></td></tr></table></figure>
<h3 id="join">Join</h3>
<ul>
<li>cross join(笛卡尔积), filter在笛卡尔积过后的表中寻找对应的行。 <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span></span><br><span class="line"><span class="keyword">FROM</span> table1, table2</span><br><span class="line"><span class="keyword">WHERE</span> <span class="operator">&lt;</span>predicate<span class="operator">&gt;</span></span><br></pre></td></tr></table></figure></li>
<li>inner join，和上述语句输出是一样的结果。 <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">    <span class="keyword">SELECT</span> <span class="operator">*</span></span><br><span class="line">    <span class="keyword">FROM</span> table1 <span class="keyword">INNER</span> <span class="keyword">JOIN</span> table2</span><br><span class="line">    <span class="keyword">ON</span> <span class="operator">&lt;</span>predicate<span class="operator">&gt;</span></span><br><span class="line"><span class="operator">-</span> <span class="keyword">outer</span> <span class="keyword">join</span>, 除了加上共有的属性值行...</span><br><span class="line">    <span class="operator">-</span> <span class="keyword">left</span> <span class="keyword">outer</span> <span class="keyword">join</span>, 加上左侧表中特有的属性值行，当前右侧表中对应的不存在的属性用<span class="keyword">NULL</span>代替。</span><br><span class="line">    <span class="operator">-</span> <span class="keyword">right</span> <span class="keyword">outer</span> <span class="keyword">join</span>, 加上右侧表中特有的属性值行。</span><br><span class="line">    <span class="operator">-</span> <span class="keyword">full</span> <span class="keyword">outer</span> <span class="keyword">join</span>, 加上两侧表中特有的属性值行。</span><br><span class="line"><span class="operator">-</span> <span class="keyword">natural</span> <span class="keyword">join</span>, <span class="operator">*</span><span class="operator">*</span>隐式地<span class="operator">*</span><span class="operator">*</span>将属性值一致的列<span class="keyword">inner</span> <span class="keyword">join</span>, 比如在当前例子中，将会自动包含<span class="keyword">join</span> <span class="keyword">condition</span>: courses.num <span class="operator">=</span> enrollment.num。</span><br><span class="line">    ``` <span class="keyword">sql</span></span><br><span class="line">    <span class="keyword">SELECT</span> ∗</span><br><span class="line">    <span class="keyword">FROM</span> courses <span class="keyword">NATURAL</span> <span class="keyword">JOIN</span> enrollment;</span><br></pre></td></tr></table></figure></li>
<li>ON后跟的是连接的predicate。</li>
</ul>
<h3 id="name-conflict">Name conflict</h3>
<ul>
<li>通过<code>列名.属性</code>来避免命名冲突。 <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> ∗</span><br><span class="line"><span class="keyword">FROM</span> courses <span class="keyword">INNER</span> <span class="keyword">JOIN</span> enrollment</span><br><span class="line"><span class="keyword">ON</span> courses.num <span class="operator">=</span> enrollment.num;</span><br></pre></td></tr></table></figure></li>
<li>通过AS来指定别名。 <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span></span><br><span class="line"><span class="keyword">FROM</span> courses <span class="keyword">AS</span> a <span class="keyword">INNER</span> <span class="keyword">JOIN</span> enrollment <span class="keyword">AS</span> b</span><br><span class="line"><span class="keyword">ON</span> A.num <span class="operator">=</span> B.num;</span><br></pre></td></tr></table></figure> ### Subqueries</li>
<li>Notes中举得例子是，需要找到课程的学生人数大于所有课程的平均学生人数的课程。如果单纯进行AVG处理，那么想要获取的行将会被过滤掉了，这时候就需要用到子查询了。 <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> num</span><br><span class="line"><span class="keyword">FROM</span> enrollment</span><br><span class="line"><span class="keyword">WHERE</span> students <span class="operator">&gt;=</span> (</span><br><span class="line">    <span class="keyword">SELECT</span> <span class="built_in">AVG</span>(students)</span><br><span class="line">    <span class="keyword">FROM</span> enrollment;</span><br><span class="line">)</span><br></pre></td></tr></table></figure> ### Set Operators</li>
<li>ANY, ALL, UNION, INTERSECT, DIFFERENCE, IN.</li>
</ul>
<h3 id="correlated-subqueries">Correlated Subqueries</h3>
<ul>
<li>子查询可以嵌套在WHERE中，也可以嵌套在FROM中。</li>
</ul>
<h3 id="pattern-matching">Pattern matching</h3>
<ul>
<li><code>%</code>可以匹配任何子串。</li>
<li><code>_</code>可以匹配任何单个字符。</li>
</ul>
<h3 id="regular-expression">Regular expression</h3>
<ul>
<li>使用前需要加~。 <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> artist_name, first_yr_active</span><br><span class="line"><span class="keyword">FROM</span> Artists</span><br><span class="line"><span class="keyword">WHERE</span> artist_name <span class="operator">~</span><span class="string">&#x27;^B.*&#x27;</span>;</span><br></pre></td></tr></table></figure></li>
</ul>
<h2 id="relation-algerbra"><strong>Relation Algerbra</strong></h2>
<p>关系代数中返回结果不包含重复的tuple。</p>
<h3 id="projectionpi">Projection(<span class="math inline">\(\pi\)</span>)</h3>
<ul>
<li><span class="math inline">\(\pi_{name}(dog)\)</span>选择对应的列，类似于SELECT name FROM dogs;</li>
<li>在关系代数中不存在操作符等价于FROM。</li>
</ul>
<h3 id="selectionsigma">Selection(<span class="math inline">\(\sigma\)</span>)</h3>
<ul>
<li>根据给定的条件过滤出具体的行。如: <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> name, age <span class="keyword">FROM</span> dogs <span class="keyword">WHERE</span> age <span class="operator">=</span> <span class="number">12</span>;</span><br></pre></td></tr></table></figure> 对应关系代数的版本 <span class="math inline">\(\pi_{name, age}(\sigma_{age = 12}(dogs))\)</span> 或者<span class="math inline">\(\sigma_{age = 12}(\pi_{name, age}(dogs))\)</span></li>
<li>Selection操作符同样支持<code>compound predicate</code>，比如<code>AND</code>可以用<span class="math inline">\(\wedge\)</span>来表示<code>OR</code>可以用<span class="math inline">\(\vee\)</span>来表示, 如: <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> name, age </span><br><span class="line"><span class="keyword">FROM</span> dogs </span><br><span class="line"><span class="keyword">WHERE</span> age <span class="operator">=</span> <span class="number">12</span> <span class="keyword">AND</span> name <span class="operator">=</span> <span class="string">&#x27;Timmy&#x27;</span>;</span><br></pre></td></tr></table></figure> 对应的关系代数版本 <span class="math inline">\(\sigma_{age=12 \wedge name=&#39;Timmy&#39;}(\pi_{name, age}(dogs))\)</span></li>
</ul>
<h3 id="unioncup">Union(<span class="math inline">\(\cup\)</span>)</h3>
<ul>
<li>Compatible: 要求union的两个操作数必须拥同样数量的attribute, 并且对应的attribute必须拥有同样的类型。</li>
</ul>
<h3 id="set-difference-">Set Difference(<span class="math inline">\(-\)</span>)</h3>
<ul>
<li>和union一样要求Compatible</li>
<li>等价于SQL的EXCEPT语句, 比如<span class="math inline">\(\pi_{name}(dogs) - \pi_{name}(cats)\)</span>只显示dogs表的行而不显示cats表的行。</li>
</ul>
<h3 id="intersectioncap">Intersection(<span class="math inline">\(\cap\)</span>)</h3>
<ul>
<li>和union一样要求Compatible。</li>
<li>等价于SQL的INTERSECT语句。</li>
</ul>
<h3 id="crossproducttimes">CrossProduct(<span class="math inline">\(\times\)</span>)</h3>
<ul>
<li>就像在SQL中执行笛卡尔积，输出两个表中行的所有组合。 <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> ∗</span><br><span class="line"><span class="keyword">FROM</span> dogs, parks;</span><br></pre></td></tr></table></figure> 等价于<span class="math inline">\(dogs \times parks\)</span>。</li>
<li>不必要求属性数量一致。</li>
</ul>
<h3 id="joinjoin">Join(<span class="math inline">\(\Join\)</span>)</h3>
<ul>
<li><code>inner join</code>: <span class="math inline">\(dogs\Join_{dogs.name=cats.name}cats\)</span>，subscript中表示join的条件，也称作Theta join, "<span class="math inline">\(\Join(\theta)\)</span>"。</li>
<li><code>Natual join</code>: <span class="math inline">\(dogs\Join cats\)</span>，上面SQL中提到过，自然连接将会把两个表中所有同样的列自动合并。</li>
<li>和selection操作符一样可以使用compound predicate。</li>
<li>join都可以由cross和selection生成。</li>
<li><span class="math inline">\(cats \Join_{\theta} dogs\)</span>和<span class="math inline">\(\sigma_{\theta}(cats \times dogs)\)</span>是等价的。</li>
<li><span class="math inline">\(cats \Join dogs\)</span>和<span class="math inline">\(\sigma_{cats.col1=dogs.col1\wedge cats.col2=dogs.col2\wedge...\wedge cats.colN=dogs.colN}(cats \times dogs)\)</span>是等价的。</li>
</ul>
<h3 id="renamerho">Rename(<span class="math inline">\(\rho\)</span>)</h3>
<ul>
<li>等价于SQL中的Alias。</li>
<li><span class="math inline">\(cats\Join_{name=dname} \rho_{name-&gt;dname}(dogs)\)</span>，将dog中的name属性重命名为dname, 避免冲突。</li>
</ul>
<h3 id="group-by-aggregationgamma">Group By/ Aggregation(<span class="math inline">\(\gamma\)</span>)</h3>
<ul>
<li>exp1 <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> age</span><br><span class="line"><span class="keyword">FROM</span> dogs</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> age</span><br><span class="line"><span class="keyword">HAVING</span> <span class="built_in">COUNT</span>(<span class="operator">*</span>) <span class="operator">&gt;</span> <span class="number">5</span>;</span><br></pre></td></tr></table></figure> 等价于<span class="math inline">\(\gamma_{age, COUNT(*)&gt;5}(dogs)\)</span></li>
<li>exp2 <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> age, <span class="built_in">SUM</span>(weight)</span><br><span class="line"><span class="keyword">FROM</span> dogs</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> age</span><br><span class="line"><span class="keyword">HAVING</span> <span class="built_in">COUNT</span>(<span class="number">8</span>) <span class="operator">&gt;</span> <span class="number">5</span>;</span><br></pre></td></tr></table></figure> 等价于<span class="math inline">\(\gamma_{age, SUM(weight), COUNT(*)&gt;5(dogs)}\)</span></li>
</ul>
<h3 id="sql---relation-algebra">SQL -&gt; Relation Algebra</h3>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> teamid <span class="keyword">AS</span> tid</span><br><span class="line"><span class="keyword">FROM</span> players</span><br><span class="line"><span class="keyword">WHERE</span> players.teamid <span class="keyword">NOT</span> <span class="keyword">IN</span></span><br><span class="line">    (<span class="keyword">SELECT</span> teamid <span class="keyword">FROM</span> teams)</span><br><span class="line"><span class="keyword">AND</span> position<span class="operator">=</span><span class="string">&#x27;shootingGuard&#x27;</span>;</span><br></pre></td></tr></table></figure>
<p>等价于 <span class="math display">\[\rho_{teamid-&gt;tid}(\pi_{teamid}(\sigma_{position=&#39;shootingGuard&#39;}(players))-\pi_{players.teamid}(players\Join_{players.teamid=teams.teamid}teams))\]</span></p>

    </div>

    
    
    

    <footer class="post-footer">

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2022/05/16/cmu15445-project1/" rel="prev" title="CMU 15-445 Project1: BUFFER POOL MANAGER">
                  <i class="fa fa-chevron-left"></i> CMU 15-445 Project1: BUFFER POOL MANAGER
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/2022/05/16/ICS-Lab-Note/" rel="next" title="ICS Lab Note">
                  ICS Lab Note <i class="fa fa-chevron-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<div class="copyright">
  &copy; 
  <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Pishun Huang</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/muse/" rel="noopener" target="_blank">NexT.Muse</a>
  </div>

    </div>
  </footer>

  
  <script src="https://cdn.jsdelivr.net/npm/animejs@3.2.1/lib/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/schemes/muse.js"></script><script src="/js/next-boot.js"></script>

  
<script src="https://cdn.jsdelivr.net/npm/hexo-generator-searchdb@1.4.0/dist/search.js" integrity="sha256-vXZMYLEqsROAXkEw93GGIvaB2ab+QW6w3+1ahD9nXXA=" crossorigin="anonymous"></script>
<script src="/js/third-party/search/local-search.js"></script>





  




  

  <script class="next-config" data-name="enableMath" type="application/json">true</script><script class="next-config" data-name="mathjax" type="application/json">{"enable":true,"tags":"none","//mhchem.github.io/MathJax-mhchem/ mhchem":false,"js":{"url":"https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js","integrity":"sha256-r+3itOMtGGjap0x+10hu6jW/gZCzxHsoKrOd7gyRSGY="}}</script>
<script src="/js/third-party/math/mathjax.js"></script>



</body>
</html>
